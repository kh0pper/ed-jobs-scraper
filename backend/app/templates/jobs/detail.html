{% extends "base.html" %}

{% block title %}{{ job.title }} - Texas Ed Jobs{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Breadcrumb -->
    <div class="breadcrumbs text-sm">
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/?mode=list">Jobs</a></li>
            <li>{{ job.title[:50] }}{% if job.title|length > 50 %}...{% endif %}</li>
        </ul>
    </div>

    <!-- Job Header -->
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <div class="flex flex-col lg:flex-row justify-between items-start gap-4">
                <div>
                    <h1 class="card-title text-3xl">{{ job.title }}</h1>
                    {% if organization %}
                    <a href="/orgs/{{ organization.id }}" class="text-xl text-primary hover:text-primary-focus mt-2 inline-block">
                        {{ organization.name }}
                    </a>
                    {% endif %}
                </div>
                <a href="{{ job.application_url }}" target="_blank" rel="noopener"
                   class="btn btn-success btn-lg gap-2">
                    Apply Now
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                    </svg>
                </a>
            </div>

            <!-- Tags -->
            <div class="flex flex-wrap gap-2 mt-4">
                {% if job.category %}
                <span class="badge badge-primary badge-lg">{{ job.category }}</span>
                {% endif %}
                {% if job.city %}
                <span class="badge badge-ghost badge-lg">{{ job.city }}</span>
                {% endif %}
                {% if job.employment_type %}
                <span class="badge badge-ghost badge-lg">{{ job.employment_type }}</span>
                {% endif %}
                <span class="badge badge-outline badge-lg">{{ job.platform }}</span>
            </div>
        </div>
    </div>

    <!-- Job Details Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Main Content -->
        <div class="lg:col-span-2 space-y-6">
            {% if job.description %}
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h2 class="card-title text-xl">Job Description</h2>
                    <div class="prose max-w-none">
                        {{ job.description | safe }}
                    </div>
                </div>
            </div>
            {% endif %}

            {% if job.requirements %}
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h2 class="card-title text-xl">Requirements</h2>
                    <div class="prose max-w-none">
                        {{ job.requirements | safe }}
                    </div>
                </div>
            </div>
            {% endif %}

            {% if not job.description and not job.requirements %}
            <div class="alert">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-info shrink-0 w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span>Full job details are available on the application page. Click "Apply Now" to view the complete posting.</span>
            </div>
            {% endif %}
        </div>

        <!-- Sidebar -->
        <div class="space-y-6">
            <!-- Job Info -->
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h3 class="card-title text-lg">Job Details</h3>
                    <dl class="space-y-3 mt-2">
                        {% if job.location %}
                        <div>
                            <dt class="text-sm opacity-70">Location</dt>
                            <dd class="font-medium">{{ job.location }}</dd>
                        </div>
                        {% endif %}
                        {% if job.department %}
                        <div>
                            <dt class="text-sm opacity-70">Department</dt>
                            <dd class="font-medium">{{ job.department }}</dd>
                        </div>
                        {% endif %}
                        {% if job.salary_text %}
                        <div>
                            <dt class="text-sm opacity-70">Salary</dt>
                            <dd class="font-medium">{{ job.salary_text }}</dd>
                        </div>
                        {% elif job.salary_min or job.salary_max %}
                        <div>
                            <dt class="text-sm opacity-70">Salary Range</dt>
                            <dd class="font-medium">
                                {% if job.salary_min and job.salary_max %}
                                ${{ "{:,.0f}".format(job.salary_min) }} - ${{ "{:,.0f}".format(job.salary_max) }}
                                {% elif job.salary_min %}
                                From ${{ "{:,.0f}".format(job.salary_min) }}
                                {% else %}
                                Up to ${{ "{:,.0f}".format(job.salary_max) }}
                                {% endif %}
                            </dd>
                        </div>
                        {% endif %}
                        {% if job.posting_date %}
                        <div>
                            <dt class="text-sm opacity-70">Posted</dt>
                            <dd class="font-medium">{{ job.posting_date.strftime('%B %d, %Y') }}</dd>
                        </div>
                        {% endif %}
                        {% if job.closing_date %}
                        <div>
                            <dt class="text-sm opacity-70">Closes</dt>
                            <dd class="font-medium text-warning">{{ job.closing_date.strftime('%B %d, %Y') }}</dd>
                        </div>
                        {% endif %}
                        <div>
                            <dt class="text-sm opacity-70">First Seen</dt>
                            <dd class="font-medium">{{ job.first_seen_at.strftime('%B %d, %Y') }}</dd>
                        </div>
                    </dl>
                </div>
            </div>

            <!-- Organization Info -->
            {% if organization %}
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h3 class="card-title text-lg">About the Organization</h3>
                    <dl class="space-y-3 mt-2">
                        <div>
                            <dt class="text-sm opacity-70">Name</dt>
                            <dd>
                                <a href="/orgs/{{ organization.id }}" class="link link-primary">
                                    {{ organization.name }}
                                </a>
                            </dd>
                        </div>
                        <div>
                            <dt class="text-sm opacity-70">Type</dt>
                            <dd class="font-medium capitalize">{{ organization.org_type }}</dd>
                        </div>
                        {% if organization.city %}
                        <div>
                            <dt class="text-sm opacity-70">City</dt>
                            <dd class="font-medium">{{ organization.city }}, TX</dd>
                        </div>
                        {% endif %}
                        {% if organization.esc_region %}
                        <div>
                            <dt class="text-sm opacity-70">ESC Region</dt>
                            <dd class="font-medium">{{ organization.esc_region }}</dd>
                        </div>
                        {% endif %}
                        {% if organization.total_students %}
                        <div>
                            <dt class="text-sm opacity-70">Total Students</dt>
                            <dd class="font-medium">{{ "{:,}".format(organization.total_students) }}</dd>
                        </div>
                        {% endif %}
                    </dl>
                </div>
            </div>
            {% endif %}

            <!-- Apply Button (sticky) -->
            <div class="sticky top-4">
                <a href="{{ job.application_url }}" target="_blank" rel="noopener"
                   class="btn btn-success btn-block btn-lg gap-2">
                    Apply for this Position
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                    </svg>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
